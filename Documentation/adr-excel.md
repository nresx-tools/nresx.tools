# ADR 0002: Вибір технології (бібліотеки) для роботи з файлами \*.excel для C\#

### Дата: 10.11.2023

### Статус: Запропоновано

### Контекст

Застосунок "Звітність" передбачає роботу з файлами \*.excel. Це включає в себе як експорт так і імпорт звітів.
Нам потрібна відповідна бібліотека, яка може парсити та генерувати файли звітності навіть при відсутності встановленого MS Excel на робочій станції.
Враховуючі достатньо великий об'єм, та кількість звітів, з якими доведеться працювати оператору (принаймні в підрозділах рівня блигади та вище) критичним є фактор швидкості роботи бібліотеки.
Також враховуючі відсутність бюджету для придбання сторонніх компонентів бібліотека має бути доступною безкоштовно для некомерційного використання в державних установах.

### Рішення

У контексті потреби роботи з файлами \*.excel для забезпечення ефективного експорту та імпорту звітів у застосунку "Звітність", було прийнято рішення використовувати бібліотеку EPPlus. 
Ця бібліотека відповідає всім критеріям наших вимог:
EPPlus дозволяє парсити та генерувати файли Excel при відсутності встановленого MS Excel на робочій станції.
Здатна забезпечити швидку та ефективну обробку великого об'єму звітів.
З версії 5.х (поточна стабільна версія - 6.х) розповзюджується за ліцензію [PolyForm Noncommercial License 1.0.0](https://polyformproject.org/licenses/noncommercial/1.0.0), 
яка дозволяє використовувати продукт безкоштовно для некомерційних державних установ.

### Наслідки



### Альтернативи

Були розглянуті наступні альтернативи:

| Технологія    | працює без MSExcel | Зручність використання | Активна підтримка | Підтримка формул  | Швидкість роботи | Вартість       |
|---------------|--------------------| -----------------------|-------------------|-------------------|------------------|---------------|
| Office interop| ~~ні~~             | ~~Низька~~                 | **Так**           | **Так**           | ~~Низька~~           | **Безкоштовно**    |
| OpenXML       | **так**            | ~~Середня~~                | **Так**           | **Так**           | Висока           | **Безкоштовно**    |
| Aspose.Cells  | **так**            | **Висока**             | **Так**           | **Так**           | Висока           | ~~Комерційна~~     |
| EPPlus 6.x    | **так**            | **Висока**             | **Так**           | **Так**           | **Висока (677ms)**   | **[PolyForm Noncommercial 1.0.0](https://polyformproject.org/licenses/noncommercial/1.0.0)**    |
| NPOI          | **так**            | **Висока**             | **Так**           | **Так**           | **Висока (1700ms)**  | **[Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0)**    |
| SmartXLS      | **так**            | ~~Середня~~                | **Так**           | **Так**           | Висока           | ~~Commercial opensource~~     |
| Spire         | **так**            | **Висока**             | **Так**           | **Так**           | Висока           | ~~Commercial opensource~~     |

